
<center style="margin-bottom: 10px;"><h1> BÁO CÁO KẾT QUẢ HOẠT ĐỘNG CỦA ĐỘI XE </h1></center>

<div >
    <form id="report" name="report" action method="post">
    Từ  <input style="width:100px" type="search" name="batdau" id="batdau" placeholder="Chọn ngày" <?php if(isset($batdau)) echo "value='$batdau'"; ?> >  
    Đến  <input style="width:100px" type="search" name="ketthuc" id="ketthuc" placeholder="Chọn ngày" <?php if(isset($ketthuc)) echo "value='$ketthuc'"; ?> >  
     <input type="submit" name="submit" id="xem" value="Xem">  
     </form>                         
</div>

<?php 
$tongthu = 0;
$tongchi = 0;
$tongnhienlieu = 0;
$tongvt = 0;
$tongcauduong = 0;
$tonganca = 0;
$tongcongan = 0;
$tongboiduong = 0;
$tonghd = 0;
$tongkhd = 0;
$tongluong = 0;
$tongkhauhao = 0;
$tonglaivay = 0;
$tongphiduongbo = 0;
$tongbh = 0;
$tonglntruoc = 0;
$tongln = 0;
$tongphatsinh = 0;

$bh = 772444.7368;
$phiduongbo = 318077.1381;
$laivay = 2788249.3092;
$khauhao = 6653998.0263;

$startTimeStamp = strtotime($batdau);
$endTimeStamp = strtotime($ketthuc);

$timeDiff = abs($endTimeStamp - $startTimeStamp);

$numberDays = $timeDiff/86400;  // 86400 seconds in one day

// and you might want to convert to integer
$numberDays = intval($numberDays)+1;

$xethue = 1644737*$numberDays;


if ( (substr($ketthuc, 3,2) - substr($batdau, 3,2) == 1 ) && (substr($batdau, 0,2) - substr($ketthuc, 0,2) == 1 ) && $xethue>50000000) {
    $xethue = 50000000;
}
if (substr($batdau, 3,2)=="01" && substr($ketthuc, 3,2)=="02") {
    if ( substr($ketthuc, 6,4)%100 != 0 && substr($ketthuc, 6,4)%4 == 0 && $numberDays == 31 ) {
        $xethue = 50000000;
    }
    if ( substr($ketthuc, 6,4)%100 != 0 && substr($ketthuc, 6,4)%4 != 0 && $numberDays == 30) {
        $xethue = 50000000;
    }
}

?>


<div class="report">
    <div class="report-left">
        <table class="table_data">
            <thead>
                <tr>
                    <th class="fix">TT</th>
                    <th class="fix">Nội dung</th>
                </tr>
           </thead>
           <tbody>
                
                <tr style=" color:rgb(0, 32, 96); font-weight:bold;">
                    <td style="text-align:center;" class="fix">I</td>
                    <td class="fix">Doanh thu</td>
                </tr>
                <tr style=" color:rgb(0, 32, 96); font-style: italic; font-weight:bold;">
                    <td style="text-align:center;" class="fix">II</td>
                    <td class="fix">Chi phí cố định</td>
                </tr>
                <tr>
                    <td style="text-align:center;" class="fix">1.</td>
                    <td class="fix">Khấu hao</td>
                </tr>
                <tr>
                    <td style="text-align:center;" class="fix">2.</td>
                    <td class="fix">Lãi vay</td>
                </tr>
                <tr>
                    <td style="text-align:center;" class="fix">3.</td>
                    <td class="fix">Phí sử dụng đường bộ</td>
                </tr>
                <tr>
                    <td style="text-align:center;" class="fix">4.</td>
                    <td class="fix">K.định, B.hiểm</td>
                </tr>
                <tr style=" color:rgb(0, 32, 96); font-style: italic; font-weight:bold;">
                    <td style="text-align:center;" class="fix">III</td>
                    <td class="fix">Có hóa đơn chứng từ</td>
                </tr>
                <tr>
                    <td style="text-align:center;" class="fix">1.</td>
                    <td class="fix">Lương tài xế</td>
                </tr>
                <tr>
                    <td style="text-align:center;" class="fix">2.</td>
                    <td class="fix">Chi phí nhiên liệu</td>
                </tr>
                
                
                <tr>
                    <td style="text-align:center;" class="fix">3.</td>
                    <td class="fix">Chi phí cầu đường</td>
                </tr>

                <tr>
                    <td style="text-align:center;" class="fix">4.</td>
                    <td class="fix">SCTX, v.tư, vá vỏ, thay vỏ</td>
                </tr>

                <tr style=" color:rgb(0, 32, 96); font-style: italic; font-weight:bold;">
                    <td style="text-align:center;" class="fix">IV</td>
                    <td class="fix">Không hóa đơn chứng từ</td>
                </tr>
                
                <tr>
                    <td style="text-align:center;" class="fix">1.</td>
                    <td class="fix">Ăn ca, Công tác phí</td>
                </tr>
                <tr>
                    <td style="text-align:center;" class="fix">2.</td>
                    <td class="fix">Chi phí phát sinh</td>
                </tr>
                
                
                <tr>
                    <td style="text-align:center;" class="fix">3.</td>
                    <td class="fix">Chi phí công an</td>
                </tr>
                <tr>
                    <td style="text-align:center;" class="fix">4.</td>
                    <td class="fix">Chi phí bồi dưỡng</td>
                </tr>
                <tr style=" color:rgb(0, 32, 96); font-weight:bold;">
                    <td style="text-align:center;" class="fix">V</td>
                    <td class="fix">LN trước thuế</td>
                </tr>
                
           </tbody>
        </table>
    </div>
    <div class="report-right">
    <div class="report-right report-right-fix" style="float:left">
        <table class="table_data">
            <thead>
                <tr>
                    <th></th>
                    <?php foreach ($vehicles as $vehicle): ?>
                    <th class="fix"><?php echo $vehicle->vehicle_number ?></th>
                    <?php endforeach; ?>
                </tr>
           </thead>
           <tbody>
                
                <tr style=" color:rgb(0, 32, 96); font-weight:bold;">
                    <td></td>
                    <?php foreach ($vehicles as $vehicle):  ?>
                    <td class="fix"><?php echo isset($doanhthu[$vehicle->vehicle_id])?$lib->formatMoney($doanhthu[$vehicle->vehicle_id]):0 ?></td>
                    <?php endforeach; ?>
                </tr>
                <tr style=" color:rgb(0, 32, 96); font-style: italic; font-weight:bold;">
                    <td></td>
                    <?php foreach ($vehicles as $vehicle):  ?>
                    <td title="<?php echo (isset($doanhthu[$vehicle->vehicle_id]) && $doanhthu[$vehicle->vehicle_id]>0?(round(((substr($vehicle->vehicle_number,0,2)=="72"?$xethue:( (round($bh/9)*$numberDays) + (round($phiduongbo/9)*$numberDays) + (round($laivay/9)*$numberDays) + (round($khauhao/9)*$numberDays) ))*100)/$doanhthu[$vehicle->vehicle_id],2)):0)."%" ?>" class="fix masterTooltip"><?php echo $lib->formatMoney( substr($vehicle->vehicle_number,0,2)=="72"?$xethue:( (round($bh/9)*$numberDays) + (round($phiduongbo/9)*$numberDays) + (round($laivay/9)*$numberDays) + (round($khauhao/9)*$numberDays) ) ); ?></td>
                    <?php endforeach; ?>
                </tr>
                <tr>
                    <td></td>
                    <?php foreach ($vehicles as $vehicle):  ?>
                    <td title="<?php echo (isset($doanhthu[$vehicle->vehicle_id]) && $doanhthu[$vehicle->vehicle_id]>0?(round(((substr($vehicle->vehicle_number,0,2)=="72"?0: round($khauhao/9)*$numberDays)*100)/$doanhthu[$vehicle->vehicle_id],2)):0)."%" ?>" class="fix masterTooltip"><?php echo $lib->formatMoney( substr($vehicle->vehicle_number,0,2)=="72"?0: round($khauhao/9)*$numberDays) ?></td>
                    <?php endforeach; ?>
                </tr>
                <tr>
                    <td></td>
                    <?php foreach ($vehicles as $vehicle):  ?>
                    <td title="<?php echo (isset($doanhthu[$vehicle->vehicle_id]) && $doanhthu[$vehicle->vehicle_id]>0?(round(((substr($vehicle->vehicle_number,0,2)=="72"?0: round($laivay/9)*$numberDays)*100)/$doanhthu[$vehicle->vehicle_id],2)):0)."%" ?>" class="fix masterTooltip"><?php echo $lib->formatMoney( substr($vehicle->vehicle_number,0,2)=="72"?0: round($laivay/9)*$numberDays) ?></td>
                    <?php endforeach; ?>
                </tr>
                <tr>
                    <td></td>
                    <?php foreach ($vehicles as $vehicle):  ?>
                    <td title="<?php echo (isset($doanhthu[$vehicle->vehicle_id]) && $doanhthu[$vehicle->vehicle_id]>0?(round(((substr($vehicle->vehicle_number,0,2)=="72"?0: round($phiduongbo/9)*$numberDays)*100)/$doanhthu[$vehicle->vehicle_id],2)):0)."%" ?>" class="fix masterTooltip"><?php echo $lib->formatMoney( substr($vehicle->vehicle_number,0,2)=="72"?0: round($phiduongbo/9)*$numberDays) ?></td>
                    <?php endforeach; ?>
                </tr>
                <tr>
                    <td></td>
                    <?php foreach ($vehicles as $vehicle):  ?>
                    <td title="<?php echo (isset($doanhthu[$vehicle->vehicle_id]) && $doanhthu[$vehicle->vehicle_id]>0?(round(((substr($vehicle->vehicle_number,0,2)=="72"?0: round($bh/9)*$numberDays)*100)/$doanhthu[$vehicle->vehicle_id],2)):0)."%" ?>" class="fix masterTooltip"><?php echo $lib->formatMoney( substr($vehicle->vehicle_number,0,2)=="72"?0: round($bh/9)*$numberDays) ?></td>
                    <?php endforeach; ?>
                </tr>

                <tr style=" color:rgb(0, 32, 96); font-style: italic; font-weight:bold;">
                    <td></td>
                    <?php foreach ($vehicles as $vehicle):  ?>
                    <td title="<?php echo (isset($doanhthu[$vehicle->vehicle_id]) && $doanhthu[$vehicle->vehicle_id]>0?(round(((round( (((isset($doanhthu[$vehicle->vehicle_id])?$doanhthu[$vehicle->vehicle_id]:0)- ( (isset($warehouse['boiduong_cn'][$vehicle->vehicle_id])?$warehouse['boiduong_cn'][$vehicle->vehicle_id]:0) + (isset($road['police_cost'][$vehicle->vehicle_id])?$road['police_cost'][$vehicle->vehicle_id]:0) ) - ((isset($road['road_time'][$vehicle->vehicle_id])?$road['road_time'][$vehicle->vehicle_id]:0)*120000) )*(10/100)) - (((isset($doanhthu['sub_driver'][$vehicle->vehicle_id])?$doanhthu['sub_driver'][$vehicle->vehicle_id]:0) - ( (isset($warehouse['sub_driver']['boiduong_cn'][$vehicle->vehicle_id])?$warehouse['sub_driver']['boiduong_cn'][$vehicle->vehicle_id]:0) + (isset($road['sub_driver']['police_cost'][$vehicle->vehicle_id])?$road['sub_driver']['police_cost'][$vehicle->vehicle_id]:0) ) - ((isset($road['sub_driver']['road_time'][$vehicle->vehicle_id])?$road['sub_driver']['road_time'][$vehicle->vehicle_id]:0)*120000) )*(8/100))  + ( isset($road['oil_cost'][$vehicle->vehicle_id])?$road['oil_cost'][$vehicle->vehicle_id]:0) + (isset($road['bridge_cost'][$vehicle->vehicle_id])?$road['bridge_cost'][$vehicle->vehicle_id]:0) + ( isset($doanhthu[$vehicle->vehicle_id])?$doanhthu[$vehicle->vehicle_id]*(7/100):0 ) ))*100)/$doanhthu[$vehicle->vehicle_id],2)):0)."%" ?>" class="fix masterTooltip">
                        <?php echo $lib->formatMoney(round( (((isset($doanhthu[$vehicle->vehicle_id])?$doanhthu[$vehicle->vehicle_id]:0)- ( (isset($warehouse['boiduong_cn'][$vehicle->vehicle_id])?$warehouse['boiduong_cn'][$vehicle->vehicle_id]:0) + (isset($road['police_cost'][$vehicle->vehicle_id])?$road['police_cost'][$vehicle->vehicle_id]:0) ) - ((isset($road['road_time'][$vehicle->vehicle_id])?$road['road_time'][$vehicle->vehicle_id]:0)*120000) )*(10/100)) - (((isset($doanhthu['sub_driver'][$vehicle->vehicle_id])?$doanhthu['sub_driver'][$vehicle->vehicle_id]:0) - ( (isset($warehouse['sub_driver']['boiduong_cn'][$vehicle->vehicle_id])?$warehouse['sub_driver']['boiduong_cn'][$vehicle->vehicle_id]:0) + (isset($road['sub_driver']['police_cost'][$vehicle->vehicle_id])?$road['sub_driver']['police_cost'][$vehicle->vehicle_id]:0) ) - ((isset($road['sub_driver']['road_time'][$vehicle->vehicle_id])?$road['sub_driver']['road_time'][$vehicle->vehicle_id]:0)*120000) )*(8/100))  + ( isset($road['oil_cost'][$vehicle->vehicle_id])?$road['oil_cost'][$vehicle->vehicle_id]:0) + (isset($road['bridge_cost'][$vehicle->vehicle_id])?$road['bridge_cost'][$vehicle->vehicle_id]:0) + ( isset($doanhthu[$vehicle->vehicle_id])?$doanhthu[$vehicle->vehicle_id]*(7/100):0 ) ) ); ?></td>
                    <?php endforeach; ?>
                </tr>
                <tr>
                    <td></td>
                    <?php foreach ($vehicles as $vehicle):  ?>
                    <td title="<?php echo (isset($doanhthu[$vehicle->vehicle_id]) && $doanhthu[$vehicle->vehicle_id]>0?(round(((round( (((isset($doanhthu[$vehicle->vehicle_id])?$doanhthu[$vehicle->vehicle_id]:0)- ( (isset($warehouse['boiduong_cn'][$vehicle->vehicle_id])?$warehouse['boiduong_cn'][$vehicle->vehicle_id]:0) + (isset($road['police_cost'][$vehicle->vehicle_id])?$road['police_cost'][$vehicle->vehicle_id]:0) ) - ((isset($road['road_time'][$vehicle->vehicle_id])?$road['road_time'][$vehicle->vehicle_id]:0)*120000) )*(10/100)) - (((isset($doanhthu['sub_driver'][$vehicle->vehicle_id])?$doanhthu['sub_driver'][$vehicle->vehicle_id]:0) - ( (isset($warehouse['sub_driver']['boiduong_cn'][$vehicle->vehicle_id])?$warehouse['sub_driver']['boiduong_cn'][$vehicle->vehicle_id]:0) + (isset($road['sub_driver']['police_cost'][$vehicle->vehicle_id])?$road['sub_driver']['police_cost'][$vehicle->vehicle_id]:0) ) - ((isset($road['sub_driver']['road_time'][$vehicle->vehicle_id])?$road['sub_driver']['road_time'][$vehicle->vehicle_id]:0)*120000) )*(8/100)) ))*100)/$doanhthu[$vehicle->vehicle_id],2)):0)."%" ?>" class="fix masterTooltip"><?php echo $lib->formatMoney(round( (((isset($doanhthu[$vehicle->vehicle_id])?$doanhthu[$vehicle->vehicle_id]:0)- ( (isset($warehouse['boiduong_cn'][$vehicle->vehicle_id])?$warehouse['boiduong_cn'][$vehicle->vehicle_id]:0) + (isset($road['police_cost'][$vehicle->vehicle_id])?$road['police_cost'][$vehicle->vehicle_id]:0) ) - ((isset($road['road_time'][$vehicle->vehicle_id])?$road['road_time'][$vehicle->vehicle_id]:0)*120000) )*(10/100)) - (((isset($doanhthu['sub_driver'][$vehicle->vehicle_id])?$doanhthu['sub_driver'][$vehicle->vehicle_id]:0) - ( (isset($warehouse['sub_driver']['boiduong_cn'][$vehicle->vehicle_id])?$warehouse['sub_driver']['boiduong_cn'][$vehicle->vehicle_id]:0) + (isset($road['sub_driver']['police_cost'][$vehicle->vehicle_id])?$road['sub_driver']['police_cost'][$vehicle->vehicle_id]:0) ) - ((isset($road['sub_driver']['road_time'][$vehicle->vehicle_id])?$road['sub_driver']['road_time'][$vehicle->vehicle_id]:0)*120000) )*(8/100)) ) ) ?></td>
                    <?php endforeach; ?>
                </tr>
                <tr>
                    <td></td>
                    <?php foreach ($vehicles as $vehicle):  ?>
                    <td title="<?php echo (isset($doanhthu[$vehicle->vehicle_id]) && $doanhthu[$vehicle->vehicle_id]>0?(round(((round($road['oil_cost'][$vehicle->vehicle_id]))*100)/$doanhthu[$vehicle->vehicle_id],2)):0)."%" ?>" class="fix masterTooltip"><?php echo isset($road['oil_cost'][$vehicle->vehicle_id])?$lib->formatMoney(round($road['oil_cost'][$vehicle->vehicle_id])):0 ?></td>
                    <?php endforeach; ?>
                </tr>
                
                
                <tr>
                    <td></td>
                    <?php foreach ($vehicles as $vehicle):  ?>
                    <td title="<?php echo (isset($doanhthu[$vehicle->vehicle_id]) && $doanhthu[$vehicle->vehicle_id]>0?(round((($road['bridge_cost'][$vehicle->vehicle_id])*100)/$doanhthu[$vehicle->vehicle_id],2)):0)."%" ?>" class="fix masterTooltip"><?php echo isset($road['bridge_cost'][$vehicle->vehicle_id])?$lib->formatMoney($road['bridge_cost'][$vehicle->vehicle_id]):0 ?></td>
                    <?php endforeach; ?>
                </tr>
                <tr>
                    <td></td>
                    <?php foreach ($vehicles as $vehicle):  ?>
                    <td title="<?php echo (isset($doanhthu[$vehicle->vehicle_id]) && $doanhthu[$vehicle->vehicle_id]>0?(round(((round($doanhthu[$vehicle->vehicle_id]*(7/100)))*100)/$doanhthu[$vehicle->vehicle_id],2)):0)."%" ?>" class="fix masterTooltip"><?php echo isset($doanhthu[$vehicle->vehicle_id])?$lib->formatMoney(round($doanhthu[$vehicle->vehicle_id]*(7/100))):0 ?></td>
                    <?php endforeach; ?>
                </tr>
                
                

                <tr style=" color:rgb(0, 32, 96); font-style: italic; font-weight:bold;">
                    <td></td>
                    <?php foreach ($vehicles as $vehicle):  ?>
                    <td title="<?php echo (isset($doanhthu[$vehicle->vehicle_id]) && $doanhthu[$vehicle->vehicle_id]>0?(round((((isset($warehouse['boiduong_cn'][$vehicle->vehicle_id])?$warehouse['boiduong_cn'][$vehicle->vehicle_id]:0) + (isset($road['police_cost'][$vehicle->vehicle_id])?$road['police_cost'][$vehicle->vehicle_id]:0) + (isset($chiphiphatsinh[$vehicle->vehicle_id])?$chiphiphatsinh[$vehicle->vehicle_id]:0) + ((isset($road['road_time'][$vehicle->vehicle_id])?$road['road_time'][$vehicle->vehicle_id]:0)*120000) )*100)/$doanhthu[$vehicle->vehicle_id],2)):0)."%" ?>" class="fix masterTooltip"><?php echo $lib->formatMoney((isset($warehouse['boiduong_cn'][$vehicle->vehicle_id])?$warehouse['boiduong_cn'][$vehicle->vehicle_id]:0) + (isset($road['police_cost'][$vehicle->vehicle_id])?$road['police_cost'][$vehicle->vehicle_id]:0) + (isset($chiphiphatsinh[$vehicle->vehicle_id])?$chiphiphatsinh[$vehicle->vehicle_id]:0) + ((isset($road['road_time'][$vehicle->vehicle_id])?$road['road_time'][$vehicle->vehicle_id]:0)*120000) ) ?></td>
                    <?php endforeach; ?>
                </tr>
                <tr>
                    <td></td>
                    <?php foreach ($vehicles as $vehicle):  ?>
                    <td title="<?php echo (isset($doanhthu[$vehicle->vehicle_id]) && $doanhthu[$vehicle->vehicle_id]>0?(round((((isset($road['road_time'][$vehicle->vehicle_id])?$road['road_time'][$vehicle->vehicle_id]:0)*120000)*100)/$doanhthu[$vehicle->vehicle_id],2)):0)."%" ?>" class="fix masterTooltip"><?php echo $lib->formatMoney((isset($road['road_time'][$vehicle->vehicle_id])?$road['road_time'][$vehicle->vehicle_id]:0)*120000) ?></td>
                    <?php endforeach; ?>
                </tr>
                <tr >
                    <td></td>
                    <?php foreach ($vehicles as $vehicle):  ?>
                    <td title="<?php echo (isset($doanhthu[$vehicle->vehicle_id]) && $doanhthu[$vehicle->vehicle_id]>0?(round((($chiphiphatsinh[$vehicle->vehicle_id])*100)/$doanhthu[$vehicle->vehicle_id],2)):0)."%" ?>" class="fix masterTooltip"><?php echo isset($chiphiphatsinh[$vehicle->vehicle_id])?$lib->formatMoney($chiphiphatsinh[$vehicle->vehicle_id]):0 ?></td>
                    <?php endforeach; ?>
                </tr>
                
                <tr>
                    <td></td>
                    <?php foreach ($vehicles as $vehicle):  ?>
                    <td title="<?php echo (isset($doanhthu[$vehicle->vehicle_id]) && $doanhthu[$vehicle->vehicle_id]>0?(round((($road['police_cost'][$vehicle->vehicle_id])*100)/$doanhthu[$vehicle->vehicle_id],2)):0)."%" ?>" class="fix masterTooltip"><?php echo isset($road['police_cost'][$vehicle->vehicle_id])?$lib->formatMoney($road['police_cost'][$vehicle->vehicle_id]):0 ?></td>
                    <?php endforeach; ?>
                </tr>
                <tr>
                    <td></td>
                    <?php foreach ($vehicles as $vehicle):  ?>
                    <td title="<?php echo (isset($doanhthu[$vehicle->vehicle_id]) && $doanhthu[$vehicle->vehicle_id]>0?(round((($warehouse['boiduong_cn'][$vehicle->vehicle_id])*100)/$doanhthu[$vehicle->vehicle_id],2)):0)."%" ?>" class="fix masterTooltip"><?php echo isset($warehouse['boiduong_cn'][$vehicle->vehicle_id])?$lib->formatMoney($warehouse['boiduong_cn'][$vehicle->vehicle_id]):0 ?></td>
                    <?php endforeach; ?>
                </tr>

                <tr style=" color:rgb(0, 32, 96); font-weight:bold;">
                    <td></td>
                    <?php foreach ($vehicles as $vehicle):  ?>
                    <td title="<?php echo (isset($doanhthu[$vehicle->vehicle_id]) && $doanhthu[$vehicle->vehicle_id]>0?(round(((round((isset($doanhthu[$vehicle->vehicle_id])?$doanhthu[$vehicle->vehicle_id]:0) - ( ((isset($warehouse['boiduong_cn'][$vehicle->vehicle_id])?$warehouse['boiduong_cn'][$vehicle->vehicle_id]:0) + (isset($road['police_cost'][$vehicle->vehicle_id])?$road['police_cost'][$vehicle->vehicle_id]:0) + (isset($chiphiphatsinh[$vehicle->vehicle_id])?$chiphiphatsinh[$vehicle->vehicle_id]:0) + ((isset($road['road_time'][$vehicle->vehicle_id])?$road['road_time'][$vehicle->vehicle_id]:0)*120000)) + ( (((isset($doanhthu[$vehicle->vehicle_id])?$doanhthu[$vehicle->vehicle_id]:0)- ( (isset($warehouse['boiduong_cn'][$vehicle->vehicle_id])?$warehouse['boiduong_cn'][$vehicle->vehicle_id]:0) + (isset($road['police_cost'][$vehicle->vehicle_id])?$road['police_cost'][$vehicle->vehicle_id]:0) ) - ((isset($road['road_time'][$vehicle->vehicle_id])?$road['road_time'][$vehicle->vehicle_id]:0)*120000) )*(10/100)) - (((isset($doanhthu['sub_driver'][$vehicle->vehicle_id])?$doanhthu['sub_driver'][$vehicle->vehicle_id]:0) - ( (isset($warehouse['sub_driver']['boiduong_cn'][$vehicle->vehicle_id])?$warehouse['sub_driver']['boiduong_cn'][$vehicle->vehicle_id]:0) + (isset($road['sub_driver']['police_cost'][$vehicle->vehicle_id])?$road['sub_driver']['police_cost'][$vehicle->vehicle_id]:0) ) - ((isset($road['sub_driver']['road_time'][$vehicle->vehicle_id])?$road['sub_driver']['road_time'][$vehicle->vehicle_id]:0)*120000) )*(8/100))  + ( isset($road['oil_cost'][$vehicle->vehicle_id])?$road['oil_cost'][$vehicle->vehicle_id]:0) + (isset($road['bridge_cost'][$vehicle->vehicle_id])?$road['bridge_cost'][$vehicle->vehicle_id]:0) ) + ( substr($vehicle->vehicle_number,0,2)=="72"?$xethue:( (round($bh/9)*$numberDays) + (round($phiduongbo/9)*$numberDays) + (round($laivay/9)*$numberDays) + (round($khauhao/9)*$numberDays) ) ) + ( isset($doanhthu[$vehicle->vehicle_id])?$doanhthu[$vehicle->vehicle_id]*(7/100):0 ) )  ))*100)/$doanhthu[$vehicle->vehicle_id],2)):0)."%" ?>" class="fix masterTooltip"><?php echo $lib->formatMoney( round((isset($doanhthu[$vehicle->vehicle_id])?$doanhthu[$vehicle->vehicle_id]:0) - ( ((isset($warehouse['boiduong_cn'][$vehicle->vehicle_id])?$warehouse['boiduong_cn'][$vehicle->vehicle_id]:0) + (isset($road['police_cost'][$vehicle->vehicle_id])?$road['police_cost'][$vehicle->vehicle_id]:0) + (isset($chiphiphatsinh[$vehicle->vehicle_id])?$chiphiphatsinh[$vehicle->vehicle_id]:0) + ((isset($road['road_time'][$vehicle->vehicle_id])?$road['road_time'][$vehicle->vehicle_id]:0)*120000)) + ( (((isset($doanhthu[$vehicle->vehicle_id])?$doanhthu[$vehicle->vehicle_id]:0)- ( (isset($warehouse['boiduong_cn'][$vehicle->vehicle_id])?$warehouse['boiduong_cn'][$vehicle->vehicle_id]:0) + (isset($road['police_cost'][$vehicle->vehicle_id])?$road['police_cost'][$vehicle->vehicle_id]:0) ) - ((isset($road['road_time'][$vehicle->vehicle_id])?$road['road_time'][$vehicle->vehicle_id]:0)*120000) )*(10/100)) - (((isset($doanhthu['sub_driver'][$vehicle->vehicle_id])?$doanhthu['sub_driver'][$vehicle->vehicle_id]:0) - ( (isset($warehouse['sub_driver']['boiduong_cn'][$vehicle->vehicle_id])?$warehouse['sub_driver']['boiduong_cn'][$vehicle->vehicle_id]:0) + (isset($road['sub_driver']['police_cost'][$vehicle->vehicle_id])?$road['sub_driver']['police_cost'][$vehicle->vehicle_id]:0) ) - ((isset($road['sub_driver']['road_time'][$vehicle->vehicle_id])?$road['sub_driver']['road_time'][$vehicle->vehicle_id]:0)*120000) )*(8/100))  + ( isset($road['oil_cost'][$vehicle->vehicle_id])?$road['oil_cost'][$vehicle->vehicle_id]:0) + (isset($road['bridge_cost'][$vehicle->vehicle_id])?$road['bridge_cost'][$vehicle->vehicle_id]:0) ) + ( substr($vehicle->vehicle_number,0,2)=="72"?$xethue:( (round($bh/9)*$numberDays) + (round($phiduongbo/9)*$numberDays) + (round($laivay/9)*$numberDays) + (round($khauhao/9)*$numberDays) ) ) + ( isset($doanhthu[$vehicle->vehicle_id])?$doanhthu[$vehicle->vehicle_id]*(7/100):0 ) )  ) ) ?></td>
                    <?php endforeach; ?>
                </tr>
                
                
           </tbody>
        </table>
    </div>

    <div style="width:150px; float:right; ">
        <table class="table_data">
            <thead>
                <tr>
                    
                    <th class="fix">Cộng</th>
                </tr>
           </thead>
           <tbody>
                
                <tr style=" color:rgb(0, 32, 96); font-weight:bold;">
                    
                    <?php foreach ($vehicles as $vehicle): $tongthu += isset($doanhthu[$vehicle->vehicle_id])?$doanhthu[$vehicle->vehicle_id]:0; ?>
                    <?php endforeach; ?>
                    <td class="fix"><?php echo $lib->formatMoney($tongthu) ?></td>
                </tr>

                <tr style=" color:rgb(0, 32, 96); font-style: italic; font-weight:bold;">
                    
                    <?php foreach ($vehicles as $vehicle): $tongchi += substr($vehicle->vehicle_number,0,2)=="72"?$xethue: ((round($bh/9)*$numberDays) + (round($phiduongbo/9)*$numberDays) + (round($laivay/9)*$numberDays) + (round($khauhao/9)*$numberDays) ); ?>
                    <?php endforeach; ?>
                    <td title="<?php echo ($tongthu>0?(round((($tongchi)*100)/$tongthu,2)):0)."%" ?>" class="fix masterTooltip"><?php echo $lib->formatMoney($tongchi) ?></td>
                </tr>
                <tr>
                    <?php foreach ($vehicles as $vehicle): $tongkhauhao += substr($vehicle->vehicle_number,0,2)=="72"?0: round($khauhao/9)*$numberDays; ?>
                    <?php endforeach; ?>
                    <td title="<?php echo ($tongthu>0?(round((($tongkhauhao)*100)/$tongthu,2)):0)."%" ?>" class="fix masterTooltip"><?php echo $lib->formatMoney($tongkhauhao) ?></td>
                </tr>
                <tr>
                    <?php foreach ($vehicles as $vehicle): $tonglaivay += substr($vehicle->vehicle_number,0,2)=="72"?0: round($laivay/9)*$numberDays; ?>
                    <?php endforeach; ?>
                    <td title="<?php echo ($tongthu>0?(round((($tonglaivay)*100)/$tongthu,2)):0)."%" ?>" class="fix masterTooltip"><?php echo $lib->formatMoney($tonglaivay) ?></td>
                </tr>
                <tr>
                    <?php foreach ($vehicles as $vehicle): $tongphiduongbo += substr($vehicle->vehicle_number,0,2)=="72"?0: round($phiduongbo/9)*$numberDays; ?>
                    <?php endforeach; ?>
                    <td title="<?php echo ($tongthu>0?(round((($tongphiduongbo)*100)/$tongthu,2)):0)."%" ?>" class="fix masterTooltip"><?php echo $lib->formatMoney($tongphiduongbo) ?></td>
                </tr>
                <tr>
                    
                    <?php foreach ($vehicles as $vehicle): $tongbh += substr($vehicle->vehicle_number,0,2)=="72"?0: round($bh/9)*$numberDays; ?>
                    <?php endforeach; ?>
                    <td title="<?php echo ($tongthu>0?(round((($tongbh)*100)/$tongthu,2)):0)."%" ?>" class="fix masterTooltip"><?php echo $lib->formatMoney($tongbh) ?></td>
                </tr>
                <tr style=" color:rgb(0, 32, 96); font-style: italic; font-weight:bold;">
                    
                    <?php foreach ($vehicles as $vehicle): $tonghd += round( (((isset($doanhthu[$vehicle->vehicle_id])?$doanhthu[$vehicle->vehicle_id]:0)- ( (isset($warehouse['boiduong_cn'][$vehicle->vehicle_id])?$warehouse['boiduong_cn'][$vehicle->vehicle_id]:0) + (isset($road['police_cost'][$vehicle->vehicle_id])?$road['police_cost'][$vehicle->vehicle_id]:0) ) - ((isset($road['road_time'][$vehicle->vehicle_id])?$road['road_time'][$vehicle->vehicle_id]:0)*120000) )*(10/100)) - (((isset($doanhthu['sub_driver'][$vehicle->vehicle_id])?$doanhthu['sub_driver'][$vehicle->vehicle_id]:0) - ( (isset($warehouse['sub_driver']['boiduong_cn'][$vehicle->vehicle_id])?$warehouse['sub_driver']['boiduong_cn'][$vehicle->vehicle_id]:0) + (isset($road['sub_driver']['police_cost'][$vehicle->vehicle_id])?$road['sub_driver']['police_cost'][$vehicle->vehicle_id]:0) ) - ((isset($road['sub_driver']['road_time'][$vehicle->vehicle_id])?$road['sub_driver']['road_time'][$vehicle->vehicle_id]:0)*120000) )*(8/100))  + ( isset($road['oil_cost'][$vehicle->vehicle_id])?$road['oil_cost'][$vehicle->vehicle_id]:0) + (isset($road['bridge_cost'][$vehicle->vehicle_id])?$road['bridge_cost'][$vehicle->vehicle_id]:0) + ( isset($doanhthu[$vehicle->vehicle_id])?$doanhthu[$vehicle->vehicle_id]*(7/100):0 ) ); ?>
                    <?php endforeach; ?>
                    <td title="<?php echo ($tongthu>0?(round((($tonghd)*100)/$tongthu,2)):0)."%" ?>" class="fix masterTooltip"><?php echo $lib->formatMoney($tonghd) ?></td>
                </tr>
                <tr>
                    <?php foreach ($vehicles as $vehicle): $tongluong += round( (((isset($doanhthu[$vehicle->vehicle_id])?$doanhthu[$vehicle->vehicle_id]:0)- ( (isset($warehouse['boiduong_cn'][$vehicle->vehicle_id])?$warehouse['boiduong_cn'][$vehicle->vehicle_id]:0) + (isset($road['police_cost'][$vehicle->vehicle_id])?$road['police_cost'][$vehicle->vehicle_id]:0) ) - ((isset($road['road_time'][$vehicle->vehicle_id])?$road['road_time'][$vehicle->vehicle_id]:0)*120000) )*(10/100)) - (((isset($doanhthu['sub_driver'][$vehicle->vehicle_id])?$doanhthu['sub_driver'][$vehicle->vehicle_id]:0) - ( (isset($warehouse['sub_driver']['boiduong_cn'][$vehicle->vehicle_id])?$warehouse['sub_driver']['boiduong_cn'][$vehicle->vehicle_id]:0) + (isset($road['sub_driver']['police_cost'][$vehicle->vehicle_id])?$road['sub_driver']['police_cost'][$vehicle->vehicle_id]:0) ) - ((isset($road['sub_driver']['road_time'][$vehicle->vehicle_id])?$road['sub_driver']['road_time'][$vehicle->vehicle_id]:0)*120000) )*(8/100)) ); ?>
                    <?php endforeach; ?>
                    <td title="<?php echo ($tongthu>0?(round((($tongluong)*100)/$tongthu,2)):0)."%" ?>" class="fix masterTooltip"><?php echo $lib->formatMoney($tongluong) ?></td>
                </tr>
                <tr>
                    <?php foreach ($vehicles as $vehicle): $tongnhienlieu += round( isset($road['oil_cost'][$vehicle->vehicle_id])?$road['oil_cost'][$vehicle->vehicle_id]:0 ); ?>
                    <?php endforeach; ?>
                    <td title="<?php echo ($tongthu>0?(round((($tongnhienlieu)*100)/$tongthu,2)):0)."%" ?>" class="fix masterTooltip"><?php echo $lib->formatMoney($tongnhienlieu) ?></td>
                </tr>
               
                
                <tr>
                    <?php foreach ($vehicles as $vehicle): $tongcauduong += isset($road['bridge_cost'][$vehicle->vehicle_id])?$road['bridge_cost'][$vehicle->vehicle_id]:0; ?>
                    <?php endforeach; ?>
                    <td title="<?php echo ($tongthu>0?(round((($tongcauduong)*100)/$tongthu,2)):0)."%" ?>" class="fix masterTooltip"><?php echo $lib->formatMoney($tongcauduong) ?></td>
                </tr>
                <tr>
                    <?php foreach ($vehicles as $vehicle): $tongvt += round(isset($doanhthu[$vehicle->vehicle_id])?$doanhthu[$vehicle->vehicle_id]*(7/100):0); ?>
                    <?php endforeach; ?>
                    <td title="<?php echo ($tongthu>0?(round((($tongvt)*100)/$tongthu,2)):0)."%" ?>" class="fix masterTooltip"><?php echo $lib->formatMoney($tongvt) ?></td>
                </tr>

                <tr style=" color:rgb(0, 32, 96); font-style: italic; font-weight:bold;">
                    
                    <?php foreach ($vehicles as $vehicle): $tongkhd += (isset($warehouse['boiduong_cn'][$vehicle->vehicle_id])?$warehouse['boiduong_cn'][$vehicle->vehicle_id]:0) + (isset($road['police_cost'][$vehicle->vehicle_id])?$road['police_cost'][$vehicle->vehicle_id]:0) + (isset($chiphiphatsinh[$vehicle->vehicle_id])?$chiphiphatsinh[$vehicle->vehicle_id]:0) + ((isset($road['road_time'][$vehicle->vehicle_id])?$road['road_time'][$vehicle->vehicle_id]:0)*120000); ?>
                    <?php endforeach; ?>
                    <td title="<?php echo ($tongthu>0?(round((($tongkhd)*100)/$tongthu,2)):0)."%" ?>" class="fix masterTooltip"><?php echo $lib->formatMoney($tongkhd) ?></td>
                </tr>
                
                <tr>
                    
                    <?php foreach ($vehicles as $vehicle): $tonganca += (isset($road['road_time'][$vehicle->vehicle_id])?$road['road_time'][$vehicle->vehicle_id]:0)*120000; ?>
                    <?php endforeach; ?>
                    <td title="<?php echo ($tongthu>0?(round((($tonganca)*100)/$tongthu,2)):0)."%" ?>" class="fix masterTooltip"><?php echo $lib->formatMoney($tonganca) ?></td>
                </tr>
                <tr >
                    
                    <?php foreach ($vehicles as $vehicle): $tongphatsinh += isset($chiphiphatsinh[$vehicle->vehicle_id])?$chiphiphatsinh[$vehicle->vehicle_id]:0; ?>
                    <?php endforeach; ?>
                    <td title="<?php echo ($tongthu>0?(round((($tongphatsinh)*100)/$tongthu,2)):0)."%" ?>" class="fix masterTooltip"><?php echo $lib->formatMoney($tongphatsinh) ?></td>
                </tr>
                
                
                <tr>
                    
                    <?php foreach ($vehicles as $vehicle): $tongcongan += isset($road['police_cost'][$vehicle->vehicle_id])?$road['police_cost'][$vehicle->vehicle_id]:0; ?>
                    <?php endforeach; ?>
                    <td title="<?php echo ($tongthu>0?(round((($tongcongan)*100)/$tongthu,2)):0)."%" ?>" class="fix masterTooltip"><?php echo $lib->formatMoney($tongcongan) ?></td>
                </tr>
                <tr>
                    
                    <?php foreach ($vehicles as $vehicle): $tongboiduong += isset($warehouse['boiduong_cn'][$vehicle->vehicle_id])?$warehouse['boiduong_cn'][$vehicle->vehicle_id]:0; ?>
                    <?php endforeach; ?>
                    <td title="<?php echo ($tongthu>0?(round((($tongboiduong)*100)/$tongthu,2)):0)."%" ?>" class="fix masterTooltip"><?php echo $lib->formatMoney($tongboiduong) ?></td>
                </tr>
                
                <tr style=" color:rgb(0, 32, 96); font-weight:bold;">
                    
                    <?php foreach ($vehicles as $vehicle): $tonglntruoc += round((isset($doanhthu[$vehicle->vehicle_id])?$doanhthu[$vehicle->vehicle_id]:0) - ( ((isset($warehouse['boiduong_cn'][$vehicle->vehicle_id])?$warehouse['boiduong_cn'][$vehicle->vehicle_id]:0) + (isset($road['police_cost'][$vehicle->vehicle_id])?$road['police_cost'][$vehicle->vehicle_id]:0) + (isset($chiphiphatsinh[$vehicle->vehicle_id])?$chiphiphatsinh[$vehicle->vehicle_id]:0) + ((isset($road['road_time'][$vehicle->vehicle_id])?$road['road_time'][$vehicle->vehicle_id]:0)*120000)) + ( (((isset($doanhthu[$vehicle->vehicle_id])?$doanhthu[$vehicle->vehicle_id]:0)- ( (isset($warehouse['boiduong_cn'][$vehicle->vehicle_id])?$warehouse['boiduong_cn'][$vehicle->vehicle_id]:0) + (isset($road['police_cost'][$vehicle->vehicle_id])?$road['police_cost'][$vehicle->vehicle_id]:0) ) - ((isset($road['road_time'][$vehicle->vehicle_id])?$road['road_time'][$vehicle->vehicle_id]:0)*120000) )*(10/100)) - (((isset($doanhthu['sub_driver'][$vehicle->vehicle_id])?$doanhthu['sub_driver'][$vehicle->vehicle_id]:0) - ( (isset($warehouse['sub_driver']['boiduong_cn'][$vehicle->vehicle_id])?$warehouse['sub_driver']['boiduong_cn'][$vehicle->vehicle_id]:0) + (isset($road['sub_driver']['police_cost'][$vehicle->vehicle_id])?$road['sub_driver']['police_cost'][$vehicle->vehicle_id]:0) ) - ((isset($road['sub_driver']['road_time'][$vehicle->vehicle_id])?$road['sub_driver']['road_time'][$vehicle->vehicle_id]:0)*120000) )*(8/100))  + ( isset($road['oil_cost'][$vehicle->vehicle_id])?$road['oil_cost'][$vehicle->vehicle_id]:0) + (isset($road['bridge_cost'][$vehicle->vehicle_id])?$road['bridge_cost'][$vehicle->vehicle_id]:0) ) + ( substr($vehicle->vehicle_number,0,2)=="72"?$xethue:( (round($bh/9)*$numberDays) + (round($phiduongbo/9)*$numberDays) + (round($laivay/9)*$numberDays) + (round($khauhao/9)*$numberDays) ) ) + ( isset($doanhthu[$vehicle->vehicle_id])?$doanhthu[$vehicle->vehicle_id]*(7/100):0 ) )  ) ; ?>
                    <?php endforeach; ?>
                    <td title="<?php echo ($tongthu>0?(round((($tonglntruoc)*100)/$tongthu,2)):0)."%" ?>" class="fix masterTooltip"><?php echo $lib->formatMoney(round($tonglntruoc)) ?></td>
                </tr>
                
           </tbody>
        </table>
    </div>
</div>
</div>

<script type="text/javascript">
    $(function() {

        var w = $(".report").width();

      $(".report-right-fix").width(w-375);


    var pickerOpts = {
        closeText: "Đóng",
        currentText: "Hiện tại",
        nextText: "Tiếp",
        prevText: "Quay lại",
        monthNames: ["Tháng 1", "Tháng 2", "Tháng 3", "Tháng 4", "Tháng 5", "Tháng 6",
        "Tháng 7", "Tháng 8", "Tháng 9", "Tháng 10", "Tháng 11", "Tháng 12"],
        monthNamesShort: ["Tháng 1", "Tháng 2", "Tháng 3", "Tháng 4", "Tháng 5", "Tháng 6",
        "Tháng 7", "Tháng 8", "Tháng 9", "Tháng 10", "Tháng 11", "Tháng 12"],
        dayNames: ["Chủ nhật", "Thứ hai", "Thứ ba", "Thứ tư", "Thứ năm",
        "Thứ sáu", "Thứ bảy"],
        dayNamesShort: ["CN", "T2", "T3", "T4", "T5",
        "T6", "T7"],
        dayNamesMin: ["CN", "T2", "T3", "T4", "T5",
        "T6", "T7"],
        //defaultDate: "+1w",
        changeMonth: true,
        changeYear: true,
        dateFormat: 'dd-mm-yy',
        firstDay: 1,
        isRTL: false,
        showButtonPanel: true,
        onClose: function(selectedDate) {
                
                $( "#ketthuc" ).datepicker( "option", "minDate", selectedDate );

         },
         
    };  
    $("#batdau").datepicker(pickerOpts);

    var pickerOpts4 = {
        closeText: "Đóng",
        currentText: "Hiện tại",
        nextText: "Tiếp",
        prevText: "Quay lại",
        monthNames: ["Tháng 1", "Tháng 2", "Tháng 3", "Tháng 4", "Tháng 5", "Tháng 6",
        "Tháng 7", "Tháng 8", "Tháng 9", "Tháng 10", "Tháng 11", "Tháng 12"],
        monthNamesShort: ["Tháng 1", "Tháng 2", "Tháng 3", "Tháng 4", "Tháng 5", "Tháng 6",
        "Tháng 7", "Tháng 8", "Tháng 9", "Tháng 10", "Tháng 11", "Tháng 12"],
        dayNames: ["Chủ nhật", "Thứ hai", "Thứ ba", "Thứ tư", "Thứ năm",
        "Thứ sáu", "Thứ bảy"],
        dayNamesShort: ["CN", "T2", "T3", "T4", "T5",
        "T6", "T7"],
        dayNamesMin: ["CN", "T2", "T3", "T4", "T5",
        "T6", "T7"],
        //defaultDate: "+1w",
        changeMonth: true,
        changeYear: true,
        dateFormat: 'dd-mm-yy',
        firstDay: 1,
        isRTL: false,
        showButtonPanel: true,
        onClose: function(selectedDate) {
                
                $( "#batdau" ).datepicker( "option", "maxDate", selectedDate );
                
         },
         
    };  
    $("#ketthuc").datepicker(pickerOpts4);
              
            
    
});



</script>
<style type="text/css">
    #ui-datepicker-div{
        font-size: 13px;
    }
    .table_data tbody tr td.fix{
        min-width: 180px;
    }
.table_data tbody tr td.fix:nth-child(1){
        min-width: 30px;
    }
.report{
    width: 100%;
    margin: -5px auto;
}
.report-left{
    float: left;
    width: 200px;
    margin-right:25px;
}
.report-right{
    
    overflow: auto;
}
.showtooltip {
        display:none;
        position:absolute;
        border:1px solid #333;
        background-color:#161616;
        border-radius:5px;
        padding:10px;
        color:#fff;
        font-size:12px Arial;
    }
</style>
<script type="text/javascript">
$(document).ready(function() {
// Tooltip only Text
$('.masterTooltip').hover(function(){
        // Hover over code
        var title = $(this).attr('title');
        $(this).data('tipText', title).removeAttr('title');
        $('<p class="showtooltip"></p>')
        .text(title)
        .appendTo('body')
        .fadeIn('slow');
}, function() {
        // Hover out code
        $(this).attr('title', $(this).data('tipText'));
        $('.showtooltip').remove();
}).mousemove(function(e) {
        var mousex = e.pageX + 20; //Get X coordinates
        var mousey = e.pageY + 10; //Get Y coordinates
        $('.showtooltip')
        .css({ top: mousey, left: mousex })
});


});

var w = $("#container").width();

      $(".container").width(w);
      $(".navbar-inner").width(w);
      $(".navbar").width(w);

$(document).ready(function() {
    function fixDiv() {
      
      var $cache = $('.navbar-fixed-top'); 
      if ($(window).scrollTop() > 42) {
        $cache.css({'position': 'fixed', 'top': '0'}); 
        $(".navbar-inner").css({'width':'100%'});
        $(".navbar").css({'width':'100%'});
      }
      else{
        var w = $("#container").width();
        $cache.css({'position': 'relative', 'top': 'auto'});
        $(".navbar-inner").width(w);
        $(".navbar").width(w);
      }
      
    }
  $(window).scroll(fixDiv);
  fixDiv();
});
</script>